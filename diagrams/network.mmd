flowchart TB
  internet((Internet)) --> wan[WAN]
  wan --> opn[anduin - OPNsense<br/>Protectli Vault FW4C]

  opn --> sw[osgiliath - Managed Switch<br/>TP-Link TL-SG108E]
  sw --> ap[ithil - UniFi U7 Pro<br/>VLAN-aware Access Point]

  subgraph vlans["VLANs / Subnets"]
    v10["VLAN10 MGMT<br/>10.10.10.0/24"]
    v20["VLAN20 SERVERS<br/>10.10.20.0/24"]
    v30["VLAN30 CLIENTS<br/>10.10.30.0/24"]
    v40["VLAN40 LAB<br/>10.10.40.0/24"]
    v50["VLAN50 IOT<br/>10.10.50.0/24"]
    v60["VLAN60 GUEST<br/>10.10.60.0/24"]
  end

  opn --- v10
  opn --- v20
  opn --- v30
  opn --- v40
  opn --- v50
  opn --- v60

  sw --> pve[orthanc - Proxmox Host<br/>runs VMs/LXCs]
  sw --> adminpc[Admin Clients<br/>PC/iPad via LAN/WiFi]
  ap --> wifi_clients[WiFi Clients]
  ap --> wifi_iot[IoT WiFi Devices]

  subgraph services["Core Services"]
    dns[palantir - Pi-hole + Unbound<br/>Authoritative local + recursive DNS]
    obs[minas-tirith - Observability<br/>Grafana + Loki + Promtail + Netdata]
    unifi[lothlorien - UniFi Controller]
    auth[elessar - Auth & Access Gateway<br/>SSO / Reverse Proxy]
    media[rivendell - Media Host<br/>Docker: Jellyfin/Audiobookshelf/*arr/qBittorrent+Gluetun]
  end

  pve --> dns
  pve --> obs
  pve --> unifi
  pve --> auth
  pve --> media

